<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome - IT Help Desk</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light d-flex align-items-center justify-content-center vh-100">

    <div class="text-center p-5 bg-white shadow rounded">
        <h1 class="mb-3 text-primary">IT Help Desk</h1>
        <p class="lead mb-4">Welcome to the internal IT support system.</p>
        
        <div id="loading" class="spinner-border text-primary d-none" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>

        <div id="action-buttons">
            <a href="login.html" class="btn btn-primary btn-lg me-2">Login</a>
            <a href="register.html" class="btn btn-outline-secondary btn-lg">Register</a>
        </div>
    </div>

    <script type="module">
        import { supabase } from './src/supabase.js'

        // Проверяваме дали потребителят вече е влязъл
        async function checkAuth() {
            const actionButtons = document.getElementById('action-buttons');
            const loading = document.getElementById('loading');
            
            actionButtons.classList.add('d-none');
            loading.classList.remove('d-none');

            const { data: { session } } = await supabase.auth.getSession();
            
            if (session) {
                // Ако е логнат, отива директно в таблото
                window.location.href = 'dashboard.html';
            } else {
                // Ако не е, показваме бутоните
                loading.classList.add('d-none');
                actionButtons.classList.remove('d-none');
            }
        }

        checkAuth();
    </script>
</body>
</html>